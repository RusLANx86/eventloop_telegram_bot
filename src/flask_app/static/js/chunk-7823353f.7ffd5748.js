(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7823353f"],{"08e6":function(e,t,i){},"2dc8":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var a=i("970b"),n=i.n(a),o=i("5bc3"),s=i.n(o),l=i("9523"),r=i.n(l),c=(i("159b"),i("d81d"),i("b64b"),i("caad"),i("2532"),i("b0c0"),i("ae3f")),d=i.n(c),f=i("f9df"),u=i("2ef0"),m=i("d29a"),p=i.n(m),g=function(){function e(){n()(this,e)}return s()(e,null,[{key:"runForm",value:function(e,t){return f.a.runForm("tg",{action:e,data:t})}},{key:"convertFormFromServer",value:function(t){var i=Object(u.cloneDeep)(t);return i.fields.forEach((function(t){t.config={model:null},t.guid=p()(10),t.type=t.type.toLowerCase(),Object(u.merge)(t.config,e.fieldTypesStructures[t.type]),Object.keys(t).map((function(e){return Object.keys(t.config).includes(e)&&(t.config[e]=null!==t[e]?Object(u.cloneDeep)(t[e]):null,delete t[e]),!0}))})),i}},{key:"submitForm",value:function(t,i){var a={};return t.fields.map((function(t){null===t.config.model||!e.validateModel(t.config.model)&&"boolean"!=typeof t.config.model&&"number"!=typeof t.config.model?a[t.config.name]=null:a[t.config.name]=t.config.model})),f.a.runForm("tg",{action:"complete",data:i,values:a})}},{key:"validateModel",value:function(e){var t=!0;return"string"==typeof e&&(t=e.length>0),t}},{key:"submitFormTest",value:function(t){var i={},a=Object(u.cloneDeep)(t.fields);return a.map((function(e,t){e.type=d()(e.type),a[t]=Object(u.merge)(e,e.config),delete a[t].config})),t.fields.map((function(t){null!==t.config.model&&e.validateModel(t.config.model)?i[t.config.name]=t.config.model:i[t.config.name]=null,delete t.model})),f.a.testForm("tg",{fields:a,values:i})}}]),e}();r()(g,"fieldTypesStructures",{text:{name:"",label:"",placeholder:"",description:"",required:!1},textarea:{name:"",label:"",description:"",required:!1},select:{name:"",placeholder:"",label:"",description:"",values:[],multiple:!1,autocomplete:!1,required:!1,model:null},number:{name:"",label:"",description:"",min:0,max:100,step:1,required:!1,model:0},date:{name:"",label:"",description:"",placeholder:"",required:!1,model:null},time:{name:"",label:"",description:"",required:!1,model:null},checkbox:{name:"",label:"",description:"",expected:null,model:!1},files:{name:"",label:"",description:"",minCount:1,maxCount:1,acceptedTypes:[],acceptAsDocuments:!1,attachToMessage:!1,model:[]}})},4142:function(e,t,i){"use strict";i.r(t);var a=(i("d3b7"),i("e6cf"),i("a79d"),i("792f")),n=i.n(a),o=i("9ae2"),s=i("a375"),l=i("2dc8"),r=i("5a6c"),c={name:"form",components:{Form:s.a,UserMeta:r.a},data:function(){return{form:null,showTimer:!1}},methods:{camelToUnderscoreCase:function(e){return n()(e)},onCountdownFinish:function(){var e=this;setTimeout((function(){e.form.return_url?window.location.href=e.form.return_url:window.close()}),1e3)},send:function(){var e=this;this.$vs.loading({container:"#loading-container_form",scale:.6}),l.a.submitForm(this.form,this.$route.params.key).then((function(t){e.form=t.data,setTimeout((function(){e.showTimer=!0}),1e3)})).catch((function(e){Object(o.a)(e)})).finally((function(){e.$vs.loading.close("#loading-container_form > .con-vs-loading")}))},getForm:function(){return l.a.runForm("open",this.$route.params.key)}},beforeRouteEnter:function(e,t,i){var a=this;i((function(e){e.$vs.loading(),e.getForm().then((function(t){"Availible"===t.data.state?e.form=l.a.convertFormFromServer(t.data):e.form=t.data})).catch((function(e){Object(o.a)(e),a.$replaceRoute({name:"error_404"})})).finally((function(){e.$vs.loading.close()}))}))}},d=(i("6891"),i("2877")),f=Object(d.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-form flex flex-col items-center justify-center",staticStyle:{"min-height":"100vh"}},[i("transition",{attrs:{name:"fade",mode:"out-in"}},[i("div",{staticClass:"vx-col w-full p-4 flex flex-col items-center justify-center"},[null!==e.form?[i("transition",{attrs:{name:"fade",mode:"out-in"}},["Availible"===e.form.state?i("div",{staticClass:"md:w-2/3 lg:w-1/3 w-full"},[i("div",{staticClass:"w-full p-4 mb-4 flex flex-row items-center justify-end"},[i("div",{staticClass:"the-navbar__user-meta flex items-center"},[i("div",{staticClass:"text-right leading-tight mr-3"},[i("p",{staticClass:"font-semibold"},[e._v(e._s(e.$store.state.userState.user.name))]),i("small",[e._v(e._s(e.$store.state.userState.user.about))])]),i("div",{staticClass:"con-img"},[i("img",{key:"localImg",staticClass:"rounded-full shadow-md cursor-default block",attrs:{src:e.$store.state.userState.user.img,alt:"user-img",width:"40",height:"40"}})])])]),i("Form",{key:"0",staticClass:"w-full",attrs:{form:e.form,"on-send":e.send,id:"loading-container_form"}})],1):i("div",{key:"1"},[i("transition",{attrs:{name:"fade",mode:"out-in"}},[e.showTimer?i("vs-card",{key:"4",staticClass:"p-8"},[i("countdown",{attrs:{"end-time":(new Date).getTime()+5e3},on:{finish:e.onCountdownFinish},scopedSlots:e._u([{key:"process",fn:function(t){var a=t.timeObj;return i("div",{staticClass:"flex flex-col flex-wrap items-center justify-center"},[i("h6",[e._v(e._s(e._f("capitalizeFirstLetter")(e.$t("form_item_redirect_in")))+":")]),i("p",{staticClass:"mt-4 text-xl"},[i("b",[e._v(e._s(a.ceil.s))])])])}}],null,!1,2261093694)},[i("div",{attrs:{slot:"finish"},slot:"finish"},[i("h6",[e._v(e._s(e._f("capitalizeFirstLetter")(e.$t("form_item_redirect"))))])])])],1):i("vs-card",{key:"3",staticClass:"p-8",class:"form-state_"+e.camelToUnderscoreCase(e.form.state).toLowerCase()},[i("div",{staticClass:"form-state__response-text text-xl"},[i("b",[e._v(e._s(e._f("capitalizeFirstLetter")(e.$t("form_state_"+e.camelToUnderscoreCase(e.form.state).toLowerCase()))))])])])],1)],1)])]:e._e()],2)])],1)}),[],!1,null,null,null);t.default=f.exports},"577f":function(e,t,i){"use strict";i("bb08")},"5a6c":function(e,t,i){"use strict";var a=(i("b0c0"),i("d3b7"),i("e6cf"),i("a79d"),i("28d1")),n={name:"UserMeta",props:{showLogout:{type:Boolean,default:!0}},computed:{user_displayName:function(){return this.$store.state.userState.user.name},activeUserImg:function(){return this.$store.state.userState.user.img},user_displayAbout:function(){return this.$store.state.userState.user.about}},methods:{logout:function(){var e=this;this.$vs.loading(),a.a.logout().catch((function(e){console.error(e)})).finally((function(){e.$router.push({name:"login"},(function(){e.$store.commit("updateUserInfo",{}),e.$store.commit("updateChatsInfo",[]),e.$store.commit("updateChat",[])})),e.$vs.loading.close()}))}}},o=i("2877"),s=Object(o.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"the-navbar__user-meta flex items-center"},[i("div",{staticClass:"text-right leading-tight hidden sm:flex flex-col mr-3"},[i("p",{staticClass:"font-semibold"},[e._v(" "+e._s(e.user_displayName)+" ")]),i("small",[e._v(e._s(e.user_displayAbout))])]),i("vs-dropdown",{class:{"cursor-pointer":e.showLogout},attrs:{"vs-custom-content":"","vs-trigger-click":""}},[i("div",{staticClass:"con-img"},[i("img",{key:"localImg",staticClass:"rounded-full shadow-md cursor-default block",attrs:{src:e.activeUserImg,alt:e.$t("main_layout_user_img_button_title").toString(),width:"40",height:"40"}})]),i("vs-dropdown-menu",{staticClass:"vx-navbar-dropdown",class:{"sm:hidden":!e.showLogout}},[i("vs-dropdown-item",{attrs:{to:{name:"profile"}}},[i("vs-icon",{attrs:{icon:"person"}}),i("span",{staticClass:"ml-2"},[e._v(e._s(e.$t("profile_menu_title")))])],1),i("vs-dropdown-item",{attrs:{to:{name:"company-registration"}}},[i("vs-icon",{attrs:{icon:"business","svg-classes":"w-4 h-4"}}),i("span",{staticClass:"ml-2"},[e._v(e._s(e.$t("company_registration_menu_title")))])],1),i("vs-dropdown-item",{on:{click:e.logout}},[i("feather-icon",{attrs:{icon:"LogOutIcon","svg-classes":"w-4 h-4"}}),i("span",{staticClass:"ml-2"},[e._v(e._s(e.$t("logout")))])],1)],1)],1)],1)}),[],!1,null,"4a3420ee",null);t.a=s.exports},6891:function(e,t,i){"use strict";i("08e6")},a375:function(e,t,i){"use strict";var a=(i("e260"),i("d3b7"),i("e6cf"),i("3ca3"),i("ddb0"),i("d81d"),i("caad"),i("2532"),i("9ae2")),n=i("bf9d"),o=i("7bb1"),s={name:"Form",components:{Field:n.a,ValidationObserver:o.a},props:{form:{required:!0,type:Object},onSend:{type:Function}},methods:{send:function(){var e=this;Promise.all(this.$refs.field.map((function(e){return e.$refs.field.validate()}))).then((function(t){return t.map((function(e){return e.valid})).includes(!1)?"":e.onSend()})).catch(a.a)}}},l=(i("577f"),i("2877")),r=Object(l.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("vs-card",{staticClass:"form-card p-8"},[i("div",{staticClass:"flex flex-row justify-center items-center  pb-0",attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"flex flex-col items-center h-full w-full break-word"},[i("h2",[e._v(e._s(e._f("capitalizeFirstLetter")(e.form.name)))]),i("p",{staticClass:"mt-4 w-2/3 text-center",domProps:{innerHTML:e._s(e.form.description)}})])]),i("div",{staticClass:"pt-8 pb-8 flex flex-col items-center justify-center"},[i("div",{staticClass:"relative",staticStyle:{"min-width":"260px","max-width":"100%"}},e._l(e.form.fields,(function(t,a){return i("Field",{key:t.guid+a,ref:"field",refInFor:!0,class:{"mt-6":a>0},attrs:{field:t,"chat-id":e.form.chat_id}})})),1)]),i("div",{staticClass:"flex flex-row justify-center items-center pt-6 pb-8 w-full",attrs:{slot:"footer"},slot:"footer"},[i("vs-button",{staticClass:"hover:text-white",attrs:{color:"primary","icon-pack":"feather",icon:"icon-send"},on:{click:e.send}},[e._v(" "+e._s(e._f("capitalizeFirstLetter")(e.$t("form_button_send")))+" ")])],1)])}),[],!1,null,null,null);t.a=r.exports},b495:function(e,t,i){"use strict";i("d22e")},bb08:function(e,t,i){},bf9d:function(e,t,i){"use strict";var a=(i("a9e3"),i("a434"),i("99af"),i("d81d"),i("0952"),i("7bb1")),n=i("c38f"),o=i.n(n),s=i("4a7a"),l=i.n(s),r=i("698d"),c=i("0692"),d=i("3786"),f=i("033d"),u=i("39ed");Object(a.c)("be_marked",(function(e){return!!e||c.a.t("validation_field_must_be_marked")})),Object(a.c)("not_be_marked",(function(e){return!e||c.a.t("validation_field_must_not_be_marked")}));var m={name:"Field",components:{flatPickr:o.a,ValidationProvider:a.b,vSelect:l.a,ConfigField:r.a,MediaUploader:d.a,FilesListRowScroll:f.a},data:function(){return{MediaEditorMode:u.a,attach:[]}},props:{field:{type:Object,required:!0},chatId:Number},watch:{"field.config.min":function(){this.processField()},attach:{handler:function(e){this.field.config.model=this.clearImagesStruct(e)},deep:!0}},computed:{getChatId:function(){return this.chatId?this.chatId:this.$store.state.chatState.chat.chat_id},rules:function(){return this.field.config.required?"required":this.field.config.expected?"be_marked":void 0!==this.field.config.expected&&!1===this.field.config.expected?"not_be_marked":""}},methods:{removeFile:function(e){this.attach.splice(e,1),this.field.config.model=[].concat(this.clearImagesStruct(this.attach))},clearImagesStruct:function(e){return e.map((function(e){return{file:e.file,type:e.type}}))},filesDataChange:function(e){this.attach.push(e)},processField:function(){this.field.config.min&&(this.field.config.model=this.field.config.min)}},mounted:function(){this.processField()}},p=(i("b495"),i("2877")),g=Object(p.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"field"},[i("ConfigField",{staticClass:"w-full",attrs:{title:e.field.config.label,required:e.field.config.required}},[i("div",{staticClass:"mt-4"},[i("ValidationProvider",{ref:"field",attrs:{rules:e.rules,name:" "},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"relative"},["select"===e.field.type&&e.field.config.values.length>0?i("v-select",{staticClass:"w-full",attrs:{placeholder:e.field.config.placeholder,multiple:e.field.config.multiple,searchable:e.field.config.autocomplete,options:e.field.config.values,name:e.field.config.name},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",t)},expression:"field.config['model']"}}):e._e()],1),"time"===e.field.type?i("flat-pickr",{staticClass:"w-full",attrs:{name:e.field.config.name,config:{enableTime:!0,enableSeconds:!0,noCalendar:!0,time_24hr:!0},placeholder:e.field.config.placeholder},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",t)},expression:"field.config['model']"}}):e._e(),"date"===e.field.type?i("flat-pickr",{staticClass:"w-full",attrs:{placeholder:e.field.config.placeholder,name:e.field.config.name},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",t)},expression:"field.config['model']"}}):e._e(),i("div",["number"===e.field.type?i("vs-input-number",{staticClass:"inline-flex",attrs:{min:e.field.config.min,max:e.field.config.max,step:e.field.config.step,name:e.field.config.name},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",e._n(t))},expression:"field.config['model']"}}):e._e()],1),"textarea"===e.field.type?i("vs-textarea",{staticClass:"mb-0 w-full",attrs:{name:e.field.config.name},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",t)},expression:"field.config['model']"}}):e._e(),"text"===e.field.type?i("vs-input",{staticClass:"w-full",attrs:{name:e.field.config.name,placeholder:e.field.config.placeholder},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",t)},expression:"field.config['model']"}}):e._e(),"checkbox"===e.field.type?i("vs-checkbox",{attrs:{name:e.field.config.name},model:{value:e.field.config.model,callback:function(t){e.$set(e.field.config,"model",t)},expression:"field.config['model']"}},[e._v(" "+e._s(e._f("capitalizeFirstLetter")(e.field.config.label))+" ")]):e._e(),"files"===e.field.type?i("div",[i("files-list-row-scroll",{attrs:{"files-data":e.attach},on:{removeFile:e.removeFile}}),i("MediaUploader",{attrs:{disabled:!1,"base-api-url":"api.chatkeeper.app/cabinet","actual-files-data":e.field.config.model,allDocument:e.field.config.acceptAsDocuments,"editor-mode":e.MediaEditorMode.TelegramAll,targetToUpload:function(){return{target:"chat_id",target_id:e.getChatId}}},on:{filesData:e.filesDataChange}})],1):e._e(),i("span",{directives:[{name:"show",rawName:"v-show",value:t.errors[0],expression:"v.errors[0]"}],staticClass:"text-danger text-sm mt-2"},[e._v(" "+e._s(e._f("capitalizeFirstLetter")(t.errors[0]))+" ")])]}}])})],1),e.field.config.description?i("small",{staticClass:"mt-2"},[e._v(e._s(e._f("capitalizeFirstLetter")(e.field.config.description)))]):e._e()])],1)}),[],!1,null,null,null);t.a=g.exports},d22e:function(e,t,i){},d29a:function(e,t,i){e.exports=i("ebcb")}}]);
//# sourceMappingURL=chunk-7823353f.7ffd5748.js.map